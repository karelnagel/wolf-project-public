---
import { AstroCookieSetOptions } from "astro";
import Layout from "../components/Layout.astro";
import { server } from "@wolf-project/backend/src/server";
const urlToken = Astro.url.searchParams.get("token");
console.log("urlToken: ", urlToken);

if (urlToken === null) return Astro.redirect("401");

const result = await server({
  userId: null,
}).authenticate.session({ token: urlToken });

if (typeof result === "string") {
  console.log('Olen siin.')
  Astro.cookies.set("x-auth-token", result, { path: "/" } as AstroCookieSetOptions);
}
---

<Layout title={undefined} description={undefined}>
  <h1>Token:</h1>
</Layout>
