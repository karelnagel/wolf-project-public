---
import { db, like } from "astro:db";
import Layout from "../../components/Layout.astro";
import { ModifyUser } from "../../components/ModifyUser";
import { Users } from "astro:db";
import { Employee } from "@wolf-project/backend/src/routes/users";

const { userId } = Astro.params;
if (!userId) throw new Error("id is required");
const query = await db
  .select({
    name: Users.name,
    email: Users.email,
    role: Users.role,
    language: Users.language,
    job: Users.job,
  })
  .from(Users)
  .where(like(Users.userId, userId));

const user = query[0] as Employee;
if (user === undefined) throw new Error("Invalid ID!");
---

<Layout title={undefined} description={undefined}>
  <h1>{user.name} kasutaja informatsioon</h1><ModifyUser
    userId={userId}
    user={user}
    client:load
  /></Layout
>
